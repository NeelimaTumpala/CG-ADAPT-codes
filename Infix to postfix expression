/*conversion of infix to postfix*/
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

#define STACK_SIZE 25

typedef struct _STACK
{
    char items[STACK_SIZE];
    int top;
}stack;

char push(char item, stack *s)
{
    /*before inserting an element check if there is any element in the stack*/
    if(s->top == STACK_SIZE-1)
    {
        printf("stack overflow\n");
        return 0;
    }
    s->top++; /*increment the stack pointer*/
    s->items[s->top]=item; /*push the item to the top of the stack*/
    return 0;
}

char pop(stack *s)
{
    char item;
    /*before removing element check if it has any elements*/
    if(s->top == -1)
    {
        printf("stack overflow\n");
        return -1;
        
    }
    item=s->items[s->top]; /*Pop the element from the top of the stack*/
    s->top--; /*and decrement the stack pointer*/
    return item;
}

/*Dispaly the contents of the satck*/

int display(stack *s)
{
    int i;
    if(s->top == -1)
    {
        printf("Stack Overflow\n");
        return -1;
        
    }
    printf("contents of the stack are: \n");
    for(i=0;i<=s->top;i++)
    {
        printf("%d",s->items[i]);
        
    }
    return 0;
    
}

int inputprecedence(char symbol)
{
    switch(symbol)
    {
        case '+' :
        case '-' :return 1;
        case '*' :
        case '/' :return 3;
        case '^' :
        case '$' : return 6; 
        
        case '(' : return 9;
        case ')' : return 0;
        default : return 7;
    }
}
int stackprecedence(char symbol)
{
    switch(symbol)
    {
        case '+' :
        case '-' :return 2;
        case '*' :
        case '/' :return 4;
        case '^' :
        case '$' : return 5; 
        
        case '(' : return 0;
        case '#' : return -1;
        default : return 8;
    }
}
void infix_postfix(char *infix, char *postfix)
{
    int i,j;
    stack s;
    char symbol;
    s.top = -1;
    push('#',&s);
    for(i=j=0;i<strlen(infix);i++)
    {
        symbol = infix[i];
        while(stackprecedence(s.items[s.top])>inputprecedence(symbol))
        {
            postfix[j++]=pop(&s);
        }
            if(stackprecedence(s.items[s.top]) != inputprecedence(symbol))
            {
                push(symbol,&s);
                
                
            }
            else
                pop(&s);
        while(s.items[s.top] != '#')
        {
            postfix[j++] = pop(&s);
        }
        postfix[j++] = '\0';
    }
    
}

int main()
{
    char infix[30],postfix[30];
    printf("enter the infix expression:");
    scanf("%d",infix);
    
    infix_postfix(infix,postfix);
    printf("\nThe postfix expression is:%s\n",postfix);
    
}
